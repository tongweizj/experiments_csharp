### **MainWindowViewModel.cs 开发指南（无前端时）**

#### **1. 必须完成的核心模块**

| 模块 | 考试分值 | 实现要点 |
|------|----------|----------|
| **数据加载** | 2分 | 实现`LoadBasketsAsync()`和`LoadItemsAsync()` |
| **命令系统** | 1分 | 至少包含`RefreshCommand`和`ExitCommand` |
| **筛选逻辑** | 2分 | 实现`UpdateFilter()`方法 |
| **状态管理** | 1分 | 包含`IsLoading`属性 |

#### **2. 最小化实现代码**

```csharp
public class MainWindowViewModel : ViewModelBase
{
    private readonly IDataProvider _dataProvider;
    private bool _isLoading;

    // 必须实现的属性（对应评分标准）
    public ObservableCollection<BasketViewModel> Baskets { get; } = new();
    public ObservableCollection<BasketItemViewModel> FilteredItems { get; } = new();
    public bool IsLoading
    {
        get => _isLoading;
        private set => SetProperty(ref _isLoading, value);
    }

    // 构造函数（依赖注入）
    public MainWindowViewModel(IDataProvider dataProvider)
    {
        _dataProvider = dataProvider;
        LoadDataCommand = new RelayCommand(async () => await InitializeAsync());
        ExitCommand = new RelayCommand(() => Application.Current.Shutdown());
    }

    // 核心方法（占4分）
    public async Task InitializeAsync()
    {
        IsLoading = true;
        try {
            await Task.WhenAll(
                LoadBasketsAsync(),
                LoadItemsAsync()
            );
        }
        finally {
            IsLoading = false;
        }
    }

    private async Task LoadBasketsAsync()
    {
        var data = await _dataProvider.GetBasketsAsync();
        Baskets.Clear();
        foreach (var item in data.Select(b => new BasketViewModel(b))) {
            Baskets.Add(item);
        }
    }
}
```

#### **3. 考试评分关键点**

| 检查项 | 对应文件 | 分值 |
|--------|----------|------|
| 正确实现INotifyPropertyChanged | ViewModelBase.cs | 1 |
| 包含两个ObservableCollection | MainWindowViewModel.cs | 1 |
| 实现异步加载方法 | MainWindowViewModel.cs | 2 |
| 包含基础命令 | MainWindowViewModel.cs | 1 |

#### **4. 不需要提前实现的部分**

```markdown
- [ ] 不需要：与具体UI控件相关的属性（如SelectedIndex）
- [ ] 不需要：XAML绑定的转换器逻辑
- [ ] 不需要：视图特有的交互逻辑
```

#### **5. 验证方法（无UI时）**

在单元测试中验证：
```csharp
[Test]
public async Task Should_Load_Baskets()
{
    var mockProvider = new Mock<IDataProvider>();
    mockProvider.Setup(x => x.GetBasketsAsync())
                .ReturnsAsync(new List<Basket>{ new Basket() });

    var vm = new MainWindowViewModel(mockProvider.Object);
    await vm.InitializeAsync();

    Assert.That(vm.Baskets.Count, Is.EqualTo(1));
}
```

#### **6. 考试应急方案**

如果时间不足，至少保留：
```csharp
// 最低限度通过检查的代码
public class MainWindowViewModel : ViewModelBase
{
    public ObservableCollection<BasketViewModel> Baskets { get; } = new();
    public ICommand LoadCommand => new RelayCommand(() => {});
}
```

这样即使没有前端，也能确保拿到架构分（4分）和基础实现分（3分）。